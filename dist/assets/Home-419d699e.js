import{u as q,j as e,a as S}from"./index-5c7438d7.js";import{B as F,a as m,u as $,N as A,M as x}from"./MasonryGrid-1de16753.js";import{r as l}from"./react-vendor-925b8206.js";import{u as C}from"./useWatchlist-3861e801.js";import{u as K,a as T,m as b,A as R}from"./framer-motion-ffdac4ed.js";const z=({item:t})=>{const n=q(),{scrollY:i}=K(),a=T(i,[0,500],[0,200]),r=T(i,[0,400],[1,0]),{addToWatchlist:o,removeFromWatchlist:c,isInWatchlist:v}=C(),[u,f]=l.useState(null),[h,p]=l.useState(!1),[d,y]=l.useState(!0),s=l.useRef(null);if(l.useEffect(()=>{let w;return t&&(f(null),p(!1),(async()=>{var N;try{const _=(N=(await m.getVideos(t.media_type||"movie",t.id)).results)==null?void 0:N.find(j=>j.site==="YouTube"&&(j.type==="Trailer"||j.type==="Teaser"));_&&(f(_.key),w=setTimeout(()=>p(!0),2500))}catch(M){console.error("Failed to fetch trailer",M)}})()),()=>clearTimeout(w)},[t]),!t)return null;const g=v(t.id),L=()=>{if(s.current){const w=d?"unMute":"mute";s.current.contentWindow.postMessage(JSON.stringify({event:"command",func:w,args:[]}),"*"),y(!d)}};return e.jsxs("div",{className:"relative h-[85vh] w-full flex items-end justify-center pb-20 overflow-hidden group bg-black",children:[e.jsxs(b.div,{style:{y:a,opacity:r},className:"absolute inset-0 z-0",children:[e.jsx("img",{src:`${F}${t.backdrop_path}`,alt:t.title,className:`absolute inset-0 w-full h-full object-cover transition-opacity duration-1000 ${h?"opacity-0":"opacity-100"}`,fetchPriority:"high"}),e.jsx(R,{children:h&&u&&e.jsx(b.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 w-full h-full pointer-events-none scale-125",children:e.jsx("iframe",{ref:s,src:`https://www.youtube.com/embed/${u}?autoplay=1&mute=1&controls=0&loop=1&playlist=${u}&showinfo=0&rel=0&iv_load_policy=3&disablekb=1&modestbranding=1&enablejsapi=1`,className:"w-full h-full object-cover",allow:"autoplay; encrypted-media",title:"Hero Trailer"})})}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#0a0a0a] via-[#0a0a0a]/40 to-transparent"}),e.jsx("div",{className:"absolute inset-0 bg-black/20 backdrop-blur-[2px]"})]}),e.jsxs("div",{className:"relative z-10 text-center max-w-4xl px-6 space-y-6",children:[e.jsxs(b.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,ease:"easeOut"},children:[e.jsx("span",{className:"inline-block py-1.5 px-4 rounded-full border border-yellow-500/30 bg-yellow-500/10 backdrop-blur-md text-[10px] md:text-xs font-bold text-yellow-400 mb-4 md:mb-6 tracking-widest uppercase shadow-[0_0_20px_rgba(234,179,8,0.2)]",children:"★ Spotlight Selection"}),e.jsx("h1",{className:"text-3xl sm:text-5xl md:text-6xl lg:text-8xl font-black tracking-tighter text-white drop-shadow-2xl mb-4 leading-[0.95] md:leading-[0.9]",children:t.title||t.name}),e.jsx("p",{className:"text-sm sm:text-lg md:text-xl text-white/80 max-w-2xl mx-auto line-clamp-3 md:line-clamp-2 leading-relaxed px-4 md:px-0",children:t.overview})]}),e.jsxs(b.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.4,duration:.5},className:"flex flex-col sm:flex-row items-center justify-center gap-4 pt-2",children:[e.jsxs("button",{onClick:()=>n(`/watch/${t.media_type||"movie"}/${t.id}`),className:"w-full sm:w-auto px-8 py-3 md:py-4 bg-white text-black rounded-full font-bold text-base md:text-lg hover:scale-105 transition-transform shadow-[0_0_40px_-10px_rgba(255,255,255,0.5)] flex items-center justify-center gap-2",children:[e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M8 5v14l11-7z"})}),"Play Now"]}),e.jsxs("button",{className:`w-full sm:w-auto px-8 py-3 md:py-4 rounded-full font-bold text-base md:text-lg transition-colors backdrop-blur-md flex items-center justify-center gap-2 ${g?"bg-white/20 text-white border border-white/20":"bg-white/10 text-white hover:bg-white/20 border border-transparent"}`,onClick:()=>g?c(t.id):o(t),children:[e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:g?e.jsx("polyline",{points:"20 6 9 17 4 12"}):e.jsx("path",{d:"M12 5v14M5 12h14"})}),e.jsx("span",{children:g?"Added":"My List"})]})]})]}),h&&e.jsx(b.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute bottom-8 right-8 z-20 hidden md:block",children:e.jsx("button",{onClick:L,className:"w-12 h-12 rounded-full border border-white/20 bg-black/30 backdrop-blur-md flex items-center justify-center text-white hover:bg-white hover:text-black transition-all duration-300 group","aria-label":d?"Unmute":"Mute",children:d?e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"})]}):e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"})})})})]})},k=({children:t,threshold:n=.1})=>{const[i,a]=l.useState(!1),r=l.useRef(null);return l.useEffect(()=>{const o=new IntersectionObserver(([c])=>{c.isIntersecting&&(a(!0),o.disconnect())},{threshold:n});return r.current&&o.observe(r.current),()=>{r.current&&o.unobserve(r.current)}},[n]),e.jsx("div",{ref:r,className:"min-h-[200px]",children:i?t:null})},V=()=>{var y;const[t,n]=S(),i=t.get("q"),a=t.get("genre"),r=t.get("name"),{watchlist:o}=C(),{data:c,isError:v,isLoading:u,refetch:f}=$({queryKey:["trending"],queryFn:()=>m.getTrending(1),retry:1}),h=(y=c==null?void 0:c.results)==null?void 0:y[0],p=[{id:28,name:"Action"},{id:12,name:"Adventure"},{id:16,name:"Animation"},{id:35,name:"Comedy"},{id:80,name:"Crime"},{id:18,name:"Drama"},{id:10751,name:"Family"},{id:14,name:"Fantasy"},{id:27,name:"Horror"},{id:878,name:"Sci-Fi"},{id:53,name:"Thriller"}],d=s=>{a===String(s.id)?n({}):n({genre:s.id,name:s.name})};return e.jsx("div",{className:"min-h-screen bg-[#0a0a0a] pb-32",children:!i&&!a?e.jsxs(e.Fragment,{children:[v?e.jsx("div",{className:"h-[85vh] w-full flex items-center justify-center",children:e.jsx(A,{onRetry:f})}):u?e.jsxs("div",{className:"relative h-[85vh] w-full bg-[#0a0a0a] overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 animate-pulse bg-white/5"}),e.jsx("div",{className:"absolute inset-x-0 bottom-0 h-1/2 bg-gradient-to-t from-[#0a0a0a] to-transparent"})]}):e.jsx(z,{item:h}),e.jsx("div",{className:"sticky top-0 z-40 py-4 mb-12 bg-[#0a0a0a]/90 backdrop-blur-xl overflow-x-auto no-scrollbar px-4 md:px-8 flex gap-3 -mx-4 md:mx-0 shadow-2xl transition-all duration-300",children:p.map(s=>e.jsx("button",{onClick:()=>d(s),className:"whitespace-nowrap px-4 py-2 md:px-6 md:py-2.5 rounded-full text-xs md:text-sm font-semibold tracking-wide transition-all border border-white/5 bg-white/5 hover:bg-white text-white/60 hover:text-black hover:scale-105 active:scale-95 shadow-sm hover:shadow-[0_0_20px_rgba(255,255,255,0.2)] flex-shrink-0",children:s.name},s.id))}),e.jsxs("div",{className:"space-y-16 relative z-10 pb-20",children:[o.length>0&&e.jsx(x,{title:"My List",queryKey:"watchlist",queryFn:()=>Promise.resolve({results:o})}),e.jsx(k,{children:e.jsx(x,{title:"Trending Now",queryKey:"trending",queryFn:()=>m.getTrending(1)})}),e.jsx(k,{children:e.jsx(x,{title:"Top Rated",queryKey:"topRated",queryFn:()=>m.getTopRated(1)})}),e.jsx(k,{children:e.jsx(x,{title:"Action Collection",queryKey:"action",queryFn:()=>m.getActionMovies(1)})})]})]}):a?e.jsxs("div",{className:"pt-32",children:[e.jsxs("div",{className:"px-4 md:px-8 mb-4 flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>n({}),className:"text-white/50 hover:text-white transition-colors flex items-center gap-2 group",children:[e.jsx("span",{className:"group-hover:-translate-x-1 transition-transform",children:"←"})," Back"]}),e.jsxs("h1",{className:"text-4xl md:text-5xl font-black tracking-tighter text-white",children:[r," Movies"]})]}),e.jsx("div",{className:"py-4 mb-8 overflow-x-auto no-scrollbar px-4 md:px-8 flex gap-3",children:p.map(s=>e.jsx("button",{onClick:()=>d(s),className:`whitespace-nowrap px-6 py-2.5 rounded-full text-sm font-semibold tracking-wide transition-all border ${a===String(s.id)?"bg-white text-black border-white shadow-[0_0_20px_rgba(255,255,255,0.3)]":"border-white/5 bg-white/5 hover:bg-white/10 text-white/60 hover:text-white"}`,children:s.name},s.id))}),e.jsx(x,{title:`Top ${r}`,queryKey:`genre-${a}`,queryFn:()=>m.getByGenre(a,1)})]}):e.jsx("div",{className:"pt-32",children:e.jsx(x,{title:`Results for "${i}"`,queryKey:`search-${i}`,queryFn:()=>m.search(i,1)})})})};export{V as default};
